## **v2.13 배포 환경 설정 (Deployment Configuration)**

*Vercel 배포 환경에서 발생하는 404 오류를 해결하기 위해 재작성(rewrite) 규칙을 추가했습니다.*

### **1. 목표**
*   싱글 페이지 애플리케이션(SPA)의 클라이언트 사이드 라우팅을 지원하여, 새로고침이나 URL 직접 입력 시에도 404 오류 없이 정상적으로 페이지가 표시되도록 합니다.

### **2. 핵심 구현 내용**
*   **`vercel.json` 파일 생성**: 프로젝트 루트에 Vercel의 서버 동작을 제어하는 `vercel.json` 설정 파일을 추가했습니다.
*   **재작성(Rewrite) 규칙 추가**: 파일 시스템에서 일치하는 경로가 없는 모든 요청(`source: "/(.*)"`)을 `index.html`로 다시 보내도록 규칙을 설정했습니다. 이를 통해 React Router가 모든 경로에 대한 제어권을 가질 수 있게 되어 404 오류가 해결됩니다.

---
## **v2.12 업데이트 완료 내역 (Completed)**

*v2.12 계획에 따라 대시보드 URL을 분리하고 라우팅 구조를 개선했습니다.*

### **1. 목표**
*   기존에 루트 경로(`/`)를 사용하던 대시보드에 명시적인 주소(`/dashboard`)를 부여하여, 애플리케이션의 전체적인 라우팅 구조를 더 명확하게 개선합니다.

### **2. 핵심 구현 내용**
*   **대시보드 경로 변경**: 대시보드 컴포넌트의 경로를 `/dashboard`로 변경했습니다.
*   **루트 경로 리디렉션**: 이제 루트 경로는 인증된 사용자를 역할(Owner/Guest)에 따라 각각 `/dashboard` 또는 최신 정산 페이지로 안내하는 리디렉션 역할을 담당합니다.
*   **전체 링크 업데이트**: `Login`, `Sidebar` 등 앱 내에서 랜딩 페이지로 연결되는 모든 링크와 페이지 이동 로직을 새로운 `/dashboard` 경로를 사용하도록 업데이트하여 일관성을 확보했습니다.

---
## **v2.10 업데이트 완료 내역 (Completed)**

*v2.10 계획에 따라 고유 URL 생성 및 라우팅 기능의 개발이 완료되었습니다.*

### **1. 목표 달성**
*   각 정산 페이지에 고유 URL(예: `/settlement/:id`)을 부여하여, 직접 주소로 접근하거나 다른 사용자에게 공유하는 기능을 구현했습니다.
*   인증되지 않은 사용자는 로그인 페이지로 먼저 안내하고, 로그인 성공 후 원래 접속하려던 페이지로 자동 이동시키는 사용자 인증 흐름을 구축했습니다.

### **2. 핵심 구현 내용**
*   **`react-router-dom` 라이브러리 도입**: `react-router-dom`을 프로젝트에 도입하여 SPA(Single Page Application) 라우팅을 구현했습니다.
*   **라우터 설정**: `main.jsx`에서 `App` 컴포넌트를 `<BrowserRouter>`로 감싸 전체 애플리케이션에 라우팅을 활성화했습니다.
*   **라우트 정의**:
    *   `/`: 비로그인 시 `Login` 컴포넌트를, 로그인 시에는 가장 최근 정산 페이지로 이동하도록 처리했습니다.
    *   `/settlement/:id`: URL의 `id` 파라미터를 `useParams` 훅으로 추출하여 해당 정산 데이터를 불러오도록 구현했습니다.
*   **컴포넌트 리팩토링**:
    *   `App.jsx`와 `SettlementPage.jsx`를 리팩토링하여, URL을 중심으로 페이지 상태를 관리하도록 구조를 변경했습니다.
    *   `Sidebar` 등 네비게이션 컴포넌트에서 `navigate` 함수 또는 `<Link>` 컴포넌트를 사용하여 페이지를 이동하도록 수정했습니다.

---
## **v2.9.1 업데이트 완료 내역 (Completed)**

*v2.9.1 계획에 따라 아래 기능들의 개발이 완료되었습니다.*

### **1. 입금 확인 기능 추가 및 개선**

*   **'입금 확인' 체크박스 행 추가**: 정산표 하단에 각 참석자별로 입금 여부를 확인할 수 있는 체크박스 행을 추가했습니다. 이를 통해 정산 완료 후 실제 입금 현황을 쉽게 추적할 수 있습니다.
*   **데이터베이스 연동**: '입금 확인' 체크박스의 상태가 데이터베이스에 저장되도록 구현하여, 언제든지 최신 상태를 유지하고 모든 사용자가 동일한 현황을 공유할 수 있습니다.
*   **완료 후 수정 기능**: 정산이 '완료' 상태로 변경된 후에도 '입금 확인' 체크박스는 계속해서 수정할 수 있도록 하여, 실제 입금 절차가 정산표 확정 이후에 이루어지는 실제 사용 흐름을 반영했습니다.

### **2. UI/UX 버그 수정**

*   **상태 변경 시 UI 자동 갱신**: '정산 완료' 또는 '수정(재활성화)' 버튼을 클릭했을 때, 페이지가 자동으로 새로고침되지 않아 사용자가 변경 사항을 즉시 확인할 수 없었던 버그를 수정했습니다. 이제 상태 변경 시 UI가 즉시 갱신되어 최신 정보를 표시합니다.

---
## **v2.1 업데이트 완료 내역 (Previously Completed)**

* **'새 정산 시작' 버튼 버그 수정**: 로그인 후 간헐적으로 버튼이 동작하지 않던 문제를 해결하고, 여러 개의 정산을 동시에 '진행 중' 상태로 관리할 수 있도록 정책을 확정했습니다.
* **'정산 재활성화' 기능 구현**: '완료'된 정산을 다시 '진행 중'으로 변경하는 기능을 구현했습니다. 이 역시 여러 '진행 중' 정산을 허용하는 정책을 따릅니다.

---
## **v2.2 업데이트 완료 내역 (Recently Completed)**

*이전 계획(v2)에 따라 아래 기능들의 개발이 완료되었습니다.*

### **1. 정산 완료 및 기록 (아카이빙) 기능**

* **"정산 완료" 버튼 추가**: 현재 정산표 아래 또는 적절한 위치에 버튼을 배치하여, 정산이 완료되었음을 명시적으로 선언하고 현재 상태를 저장하는 역할을 합니다.
* **실수 방지를 위한 확인 절차**: "정산 완료" 버튼 클릭 시, "정말로 정산을 완료하시겠습니까? 완료 후에는 수정할 수 없습니다." 와 같은 확인 모달 창을 표시하여 사용자의 실수를 방지합니다.
* **정산 내역 스냅샷 저장**: "정산 완료"가 최종 확인되면, 페이지 제목, 정산표 데이터(참여자, 비용 항목 등), 해당 정산에 달린 모든 댓글을 하나의 묶음(스냅샷)으로 영구 저장합니다.

### **2. 과거 정산 내역 조회 및 관리 기능**

* **사이드바(폴더 트리) UI 추가**: 화면 좌측에 저장된 모든 정산 내역 목록을 표시하는 사이드바를 구현합니다.
* **편의 기능 추가**:
    * **검색**: 사이드바 상단에 제목이나 참여자 이름으로 과거 내역을 검색할 수 있는 입력창을 추가합니다.
    * **정렬**: 목록을 '최신순'(기본값), '오래된순', '제목순'으로 정렬할 수 있는 옵션을 제공합니다.
* **과거 내역 불러오기**: 사이드바에서 특정 내역을 클릭하면, 해당 시점의 데이터를 읽기 전용(read-only) 모드로 불러와 화면에 표시합니다.
* **과거 내역 관리 기능**:
    * **재활용 (보류)**: "이 내역으로 새로 정산하기" 기능은 현재 우선순위에서 제외하고 추후 재검토합니다.
    * **삭제**: 읽기 전용 화면 또는 사이드바 목록에서 특정 내역을 삭제할 수 있는 버튼을 추가하고, 실수 방지를 위해 확인 절차를 포함합니다.

### **3. 정산 상태 관리 및 재활성화 기능**

* **목표**: 버전 관리의 복잡도 증가 없이, 사용자가 실수로 '정산 완료'한 내역을 다시 수정할 수 있도록 하여 사용자 경험을 개선합니다.
* **구현 방안**:
    1.  **데이터베이스 설계**: `settlements` 테이블에 **`status` 컬럼을 추가**합니다. 이 컬럼은 `active`(활성/편집 중) 또는 `archived`(보관/완료) 두 가지 상태 값을 가집니다.
    2.  **'정산 완료' 시 로직**:
        * 사용자가 '정산 완료'를 최종 확인하면, 해당 정산 데이터의 `status`를 `archived`로 업데이트합니다.
        * 프론트엔드에서는 `status`가 `archived`인 데이터를 '과거 정산 내역' 목록에 표시하고, 읽기 전용으로 처리합니다.
    3.  **'정산 재활성화' 기능 추가 (관리자 또는 특정 권한)**:
        * 읽기 전용 화면에 **"수정하기 (재활성화)" 버튼을 추가**합니다.
        * 버튼 클릭 시, "보관된 정산을 다시 수정하시겠습니까?" 와 같은 확인 절차를 거칩니다.
        * 사용자가 확인하면, 해당 데이터의 `status`를 다시 `active`로 변경합니다.
        * `status`가 `active`로 변경된 데이터는 '과거 정산 내역' 목록에서 사라지고, 다시 메인 정산 편집 화면으로 불러와 수정을 이어갈 수 있게 합니다.

---
## **v2.3 업데이트 완료 내역 (Completed)**

*v2.3 계획에 따라 아래 기능들의 개발이 완료되었습니다.*

### **1. 정산표 UI/UX 개선**

* **제목 행 및 열 고정 기능 (Sticky Headers)**: 사용자가 상하좌우로 스크롤 하더라도 참석자 이름이 표시된 제목 행과 비용 항목이 표시된 제목 열은 항상 화면에 고정되어 보이도록 수정합니다. 이 기능은 모바일과 데스크톱 환경 모두에 동일하게 적용하여 가독성을 극대화합니다.
* **비용 열 너비 고정**: 비용 항목의 금액을 수정할 때 일시적으로 열 너비가 변경되는 현상을 수정합니다. 비용 열은 최대 7자리 숫자(백만 단위)와 '원' 단위를 표시할 수 있는 고정 너비를 가져야 합니다.
* **비용 열 정렬 통일**: 개별 비용 항목과 비용 차감 항목의 우측 정렬 및 여백을 일치시켜 가독성을 높입니다.
* **참석자 수 카운트**: 개별 비용 항목을 분담해야하는 참석자(체크박스에 체크된 참석자)의 숫자를 표시하는 열을 '사비'열과 참석자 열 사이에 추가하고 열 제목은 'N'으로 지정합니다. 이 열의 값에 마우스 오버(모바일의 경우 터치)하면 비용을 분담 대상 참석자의 수로 나눈 값인 1인당 비용을 보여주는 툴팁을 표시합니다.
    * **(추가) 툴팁 금액 정책**: 1인당 비용 계산 시 소수점 이하는 **내림 처리**하여 1원 단위로 표시합니다.

### **2. 참석자 조회 기능 추가**

* **참석자 필터 UI 추가**: 정산표 좌측 상단에 필터 버튼 및 참석자 선택 UI를 추가합니다.
* **필터 기능 강화**:
    * **드롭다운 선택**: 현재 등록된 참석자 목록을 드롭다운(Dropdown)으로 제공하여 오타 없이 쉽게 선택할 수 있도록 합니다.
    * **결과 하이라이트**: 참석자 선택 시, 해당 참석자와 관련된 정산표 항목만 표시하며, **시각적으로 눈에 띄게 강조(highlight)**하여 가독성을 높입니다.
    * **(추가) 필터 해제**: 필터 UI 내에 **'필터 해제' 또는 '전체 보기' 버튼을 추가**하여 사용자가 쉽게 전체 정산 내역으로 돌아올 수 있도록 합니다.

### **3. 부가 기능 추가**

* **댓글 내 사진 첨부 기능**:
    * **기능 정의**: 사용자가 댓글을 작성할 때 영수증, 모임 사진 등 사진 파일을 첨부할 수 있도록 합니다.
    * **이미지 최적화 (필수)**: 업로드된 이미지는 스토리지 비용 절감 및 빠른 로딩 속도를 위해 웹 환경에 최적화된 크기(예: 최대 1920px)와 용량으로 자동 리사이즈 및 압축하여 저장합니다. 이는 안정성을 위해 클라이언트와 서버 양단에서 모두 처리하는 것을 원칙으로 합니다.
    * **구현 범위 (1단계 - MVP)**:
        * 댓글 하나당 여러 개의 이미지를 첨부하도록 개선.
        * 단순 파일 선택 버튼으로 업로드 기능 제공.
        * 첨부된 사진은 댓글 내용과 함께 표시.
* **댓글 삭제 기능 (소프트 딜리트)**: 사용자가 댓글을 삭제할 경우, 웹페이지에서는 보이지 않도록 처리하되 데이터베이스에는 삭제 상태(예: `is_deleted: true`)로 기록을 남겨 데이터를 보존합니다.
* **댓글 수정 기능**: 사용자가 본인이 작성한 댓글의 내용을 수정할 수 있는 기능을 추가합니다.
* **(신규) 정산 완료 후 댓글 기능 유지**: 정산 상태가 'archived'(보관/완료)로 변경되어 정산표 자체는 읽기 전용(read-only)이 되더라도, 해당 정산에 대한 댓글은 이전과 동일하게 작성, 수정, 삭제할 수 있도록 기능을 유지합니다.
* **정산중 알람**: 정산 완료를 눌러 'archived' 상태가 되지 않은 상태일 때 페이지에 접속하면 "정산중입니다. 입금 금지!"라는 내용의 경고 메세지를 띄웁니다.
    * **(추가) 알림 방식**: 해당 경고 메시지는 **페이지 진입 시 팝업(Pop-up) 형태**로 표시하여 사용자가 명확히 인지하도록 합니다.

---
## **v2.4 업데이트 완료 내역 (Completed)**

*v2.4 계획에 따라 아래 기능들의 개발이 완료되었습니다.*

### **1. 대댓글 기능 추가**

*   **UI/UX 개선:**
    *   **'답글 달기' 버튼 추가:** 각 댓글에 '답글 달기' 버튼을 추가하여 특정 댓글에 대한 답글을 작성할 수 있도록 구현했습니다.
    *   **들여쓰기 적용:** 대댓글은 원본 댓글보다 안쪽으로 들여쓰기하여 계층 구조를 시각적으로 명확하게 표시합니다.
*   **데이터베이스 설계:**
    *   `comments` 테이블에 `parent_comment_id` 컬럼을 추가하여 부모-자식 관계를 형성하도록 스키마를 확장했습니다. (Self-referencing foreign key)
*   **로직 구현:**
    *   댓글을 불러올 때 `parent_comment_id`를 기준으로 계층 구조를 재구성하여 화면에 표시하도록 구현했습니다.
*   **(추가) 댓글 삭제 정책 개선:**
    *   **'삭제된 댓글입니다' 기능:** 대댓글이 있는 댓글이 삭제될 경우, 바로 사라지지 않고 '삭제된 댓글입니다'라는 플레이스홀더로 표시되어 기존 대화의 맥락을 유지하도록 개선했습니다.
    *   **자동 숨김 처리:** '삭제된 댓글'의 하위 대댓글이 모두 삭제되면, 상위의 '삭제된 댓글입니다' 플레이스홀더도 자동으로 사라지도록 구현하여 UI를 깔끔하게 유지합니다.

---
## **v2.5 업데이트 완료 내역 (Completed)**

*v2.5 계획에 따라 아래 기능들의 개발이 완료되었습니다.*

### **1. 사용자 프로필 기능 구현 (Phase 1)**
*   **목표 달성**: 기존에 '총무'로 고정 표시되던 인증 사용자 이름을, 각 사용자가 직접 설정한 이름으로 표시되도록 개선했습니다.
*   **데이터베이스 (Supabase)**
    *   `profiles` 테이블을 생성하여 `auth.users`와 연결하고, `username`을 저장하도록 구현했습니다.
    *   신규 가입 시 `profiles` 테이블에 정보가 자동 생성되도록 트리거를 설정했습니다.
    *   자신의 프로필만 수정 가능하도록 RLS(보안 정책)를 설정했습니다.
*   **프론트엔드 (React)**
    *   **프로필 수정 UI 개선**: 사이드바의 '이름 변경' 버튼 클릭 시, 모달 팝업을 통해 사용자 이름을 수정하는 방식으로 UX를 개선했습니다.
    *   **로그아웃 버튼 이동**: 헤더에 있던 로그아웃 버튼을 사이드바로 이동시켜 사용자 관련 기능을 한 곳에 모았습니다.
    *   **댓글 표시 로직 수정**: 댓글 조회 시 `profiles` 테이블을 JOIN하여, 설정된 `username`이 표시되도록 수정했습니다.
    *   **UI 스타일 수정**: 전반적인 요청에 따라 댓글 창 및 정산표의 글자 크기를 축소하고, 썸네일 최대 크기를 제한하는 등 UI를 다듬었습니다.

---
## **v2.6 업데이트 완료 내역 (Completed)**

*v2.6 계획에 따라 댓글 공지 기능의 개발이 완료되었습니다.*

### **1. 목표**
*   ~~인증된 사용자가~~ **정산 생성자(Owner)가** 특정 댓글을 '공지'로 지정하여 댓글 목록 최상단에 고정하고 강조 표시하는 기능을 구현합니다.

### **2. 데이터베이스 (Supabase)**
*   `comments` 테이블에 `is_pinned` (boolean, default: `false`) 컬럼을 추가했습니다.

### **3. 백엔드 (Supabase Functions)**
*   **댓글 고정/해제 RPC 생성**: `pin_comment`와 `unpin_comment` 데이터베이스 함수를 생성하여, 한 번에 하나의 공지만 허용되도록 로직을 구현했습니다.

### **4. 프론트엔드 (React)**
*   **UI 변경**:
    *   각 댓글에 '공지로 등록' / '공지 해제' 버튼을 추가했습니다. (정산 생성자에게만 표시)
*   **공지 섹션 추가**:
    *   댓글 목록 최상단에, 시각적으로 강조된 별도의 공지 섹션을 만들어 고정된 댓글을 표시하도록 구현했습니다.
*   **로직 수정**:
    *   `CommentSection.jsx`에서 데이터를 가져올 때, 공지 댓글과 일반 댓글을 분리하여 처리하도록 로직을 수정했습니다.

### **(추가) 버그 수정 및 최종 아키텍처**
*   **문제 발생**: 기능 구현 직후, 공지 버튼을 클릭해도 UI가 갱신되지 않는 버그가 발생했습니다.
*   **디버깅 과정**:
    1.  **1차 시도 (수동 새로고침)**: 작업 완료 후 `fetchComments()`를 호출하여 UI를 갱신하도록 했으나 실패했습니다.
    2.  **2차 시도 (지연 시간 추가)**: 데이터베이스 반영 지연을 고려해 `setTimeout`으로 지연 시간을 주었으나 이 역시 실패했습니다.
    3.  **원인 분석**: 여러 테스트를 통해, `comments_with_profiles`라는 데이터베이스 **뷰(View)**가 변경된 데이터를 즉시 반영하지 못하고, 캐시된 이전 데이터를 계속 반환하는 것이 근본적인 원인임을 확인했습니다.
*   **최종 해결**:
    *   문제가 되는 뷰를 더 이상 사용하지 않도록 `fetchComments` 함수를 전면 재작성했습니다.
    *   이제 `comments`와 `profiles` 두 테이블에서 직접 데이터를 각각 가져온 후, 클라이언트(브라우저)에서 두 데이터를 조합하여 최종 목록을 만듭니다.
    *   이 방식으로 뷰의 캐시 문제를 완전히 우회하여 데이터 정합성을 확보하고 버그를 해결했습니다.

---
## **v2.9 업데이트 완료 내역 (Completed)**

*v2.9 계획에 따라 아래 기능들의 개발이 완료되었습니다.*

### **1. iOS 환경 댓글 이미지 첨부 성능 최적화**

*   **문제 해결**: 아이폰(iOS) 환경에서 댓글에 이미지를 첨부한 후, 텍스트를 입력할 때 키보드 반응이 심하게 느려지는(스터터링) 문제를 해결했습니다.
*   **원인 분석**: 최초 원인으로 예상됐던 클라이언트 측 압축 로직이 아닌, 이미지 미리보기를 생성하는 `URL.createObjectURL` API가 iOS 기기의 메모리에 과도한 부담을 주어 UI 렌더링을 차단하는 것으로 최종 확인되었습니다.
*   **개선 방안 (FileReader API로 전환)**:
    *   성능 문제를 해결하기 위해, 이미지 미리보기 생성 방식을 `URL.createObjectURL`에서 `FileReader.readAsDataURL`로 전면 교체했습니다.
    *   이 방식은 이미지 파일을 메모리에 직접 상주시키는 대신 Base64 데이터 URL으로 변환하여 사용하므로, 메모리 부하가 적어 UI 반응성이 안정적으로 유지됩니다.

---
## 개발 우선순위 추천 (Recommended Development Priority)

*아래 계획들의 효율적이고 안정적인 개발을 위해 다음 순서대로 진행하는 것을 추천합니다.*

1.  **v2.7: 역할 기반 권한 관리 (RBAC)**: 안정적인 아키텍처 위에 세분화된 권한을 구현하는 것이 가장 효율적입니다.

---
## **v2.11 업데이트 완료 내역 (Completed)**

*v2.11 계획에 따라 대시보드 랜딩 페이지 구현 및 라우팅 구조 리팩토링이 완료되었습니다.*

### **1. 목표 달성**
*   **대시보드 랜딩 페이지 구현**: 로그인한 사용자를 위한 랜딩 페이지(`Dashboard.jsx`)를 구현했습니다. 이 페이지는 환영 메시지, 빠른 실행 버튼(새 정산, 이어하기), 최근 정산 목록을 제공하여 사용자 경험을 향상시킵니다.
*   **인증 라우팅 구조 개편**: 표준적인 'Private Route' 방식을 도입하여 인증 흐름을 대대적으로 리팩토링했습니다. 이를 통해 로그인 시 발생하던 복잡한 리디렉션 문제를 근본적으로 해결하고, 코드의 안정성과 확장성을 확보했습니다.

### **2. 핵심 구현 내용**
*   **`PrivateRoute.jsx` 컴포넌트 도입**: 로그인이 필요한 모든 경로를 감싸, 비로그인 사용자는 `/login` 페이지로 보내고 원래 접속하려던 경로를 기억하도록 구현했습니다.
*   **`/login` 전용 라우트 생성**: 기존의 인플레이스(in-place) 로그인 방식 대신, 별도의 로그인 페이지(`/login`)를 통해 인증을 처리하도록 변경했습니다.
*   **`Login.jsx` 로직 수정**: 로그인 성공 후, `PrivateRoute`로부터 전달받은 이전 경로로 사용자를 정확히 돌려보내도록 수정했습니다.
*   **`App.jsx` 구조 개편**: 새로운 라우팅 시스템에 맞춰 `Routes`를 재구성하고, 복잡했던 `useEffect` 훅들을 정리하여 인증 및 데이터 로딩 로직을 단순화하고 명확하게 만들었습니다.
*   **게스트 사용자 흐름 유지**: 게스트 사용자가 루트(`/`)로 접속할 경우, 대시보드 대신 기존처럼 최신 정산 페이지로 이동하도록 리디렉션 로직을 유지하여 일관된 사용성을 제공합니다.

---
## **v2.8 업데이트 완료 내역 (Completed)**

*v2.8 계획에 따라 구글(Google) 및 카카오(Kakao) 소셜 로그인 기능의 개발이 완료되었습니다.*

### **1. 목표 달성**
*   사용자가 기존 이메일 방식 외에, 구글과 카카오 계정을 통해 간편하게 로그인할 수 있도록 기능을 구현하여 편의성을 높였습니다.

### **2. 핵심 구현 내용**
*   **`Login.jsx` 수정**:
    *   로그인 페이지에 '구글로 로그인'과 '카카오로 로그인' 버튼을 추가했습니다.
    *   각 버튼 클릭 시, Supabase의 `signInWithOAuth` 함수를 호출하여 각 소셜 로그인 프로세스를 시작하도록 `handleOAuthLogin` 핸들러를 구현했습니다.
*   **Supabase 연동**: 사용자가 Supabase 대시보드에서 구글 및 카카오 OAuth 제공업체를 활성화하고 필요한 Client ID와 Secret을 설정하는 것을 전제로 프론트엔드 로직을 구현했습니다.
*   **카카오 로그인 이슈 해결**: 개발 과정에서 발견된 카카오 이메일 수집 권한 문제를 사용자가 '비즈 앱' 등록을 통해 해결하여, 최종적으로 기능을 완성했습니다.

---
## **v2.7 개발 계획 (Phase 2: 역할 기반 권한 관리 - RBAC)**

### **1. 목표**
*   '관리자(admin)'와 '일반 인증 사용자(member)' 역할을 도입하여 보다 세분화된 권한 관리 시스템을 구축합니다.

### **2. 데이터베이스 (Supabase)**
*   **`profiles` 테이블 확장**:
    *   `role` (text) 컬럼을 추가합니다. (예: `admin`, `member`)
*   **신규 사용자 트리거 수정**:
    *   회원가입 시 `role`의 기본값으로 `member`를 부여하도록 트리거를 수정합니다.
*   **모든 테이블의 보안 정책(RLS) 재설계**:
    *   기존의 단순 인증 여부 기반의 정책을, `profiles` 테이블의 `role`을 확인하는 역할 기반 정책으로 전면 재작성합니다.
    *   예: "정산 내역 삭제는 `admin` 역할만 가능하다."

### **3. 백엔드 (Supabase Functions)**
*   **사용자 승급 RPC 생성**:
    *   `admin` 역할을 가진 사용자가 다른 `member`를 `admin`으로 승급시킬 수 있는 데이터베이스 함수(RPC)를 작성합니다.

### **4. 프론트엔드 (React)**
*   **관리자 페이지 UI**:
    *   사용자 목록과 역할을 확인하고, '승급' 버튼을 통해 사용자를 관리자로 만들 수 있는 UI를 구현합니다.
*   **전체 UI 권한 분리**:
    *   사용자의 `role`에 따라 수정/삭제/관리 버튼이 보이거나 숨겨지도록 모든 관련 컴포넌트를 리팩토링합니다.