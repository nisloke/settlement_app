## 완료된 작업 (v2.1)

- **'새 정산 시작' 버튼 버그 수정**: 로그인 후 간헐적으로 버튼이 동작하지 않던 문제를 해결하고, 여러 개의 정산을 동시에 '진행 중' 상태로 관리할 수 있도록 정책을 확정했습니다.
- **'정산 재활성화' 기능 구현**: '완료'된 정산을 다시 '진행 중'으로 변경하는 기능을 구현했습니다. 이 역시 여러 '진행 중' 정산을 허용하는 정책을 따릅니다.

---

### **향후 개발 계획 (Future Development Plan) - 최종본 v2**

### **1. 정산 완료 및 기록 (아카이빙) 기능**

* **"정산 완료" 버튼 추가**: 현재 정산표 아래 또는 적절한 위치에 버튼을 배치하여, 정산이 완료되었음을 명시적으로 선언하고 현재 상태를 저장하는 역할을 합니다.
* **실수 방지를 위한 확인 절차**: "정산 완료" 버튼 클릭 시, "정말로 정산을 완료하시겠습니까? 완료 후에는 수정할 수 없습니다." 와 같은 확인 모달 창을 표시하여 사용자의 실수를 방지합니다.
* **정산 내역 스냅샷 저장**: "정산 완료"가 최종 확인되면, 페이지 제목, 정산표 데이터(참여자, 비용 항목 등), 해당 정산에 달린 모든 댓글을 하나의 묶음(스냅샷)으로 영구 저장합니다.

### **2. 과거 정산 내역 조회 및 관리 기능**

* **사이드바(폴더 트리) UI 추가**: 화면 좌측에 저장된 모든 정산 내역 목록을 표시하는 사이드바를 구현합니다.
* **편의 기능 추가**:
    * **검색**: 사이드바 상단에 제목이나 참여자 이름으로 과거 내역을 검색할 수 있는 입력창을 추가합니다.
    * **정렬**: 목록을 '최신순'(기본값), '오래된순', '제목순'으로 정렬할 수 있는 옵션을 제공합니다.
* **과거 내역 불러오기**: 사이드바에서 특정 내역을 클릭하면, 해당 시점의 데이터를 읽기 전용(read-only) 모드로 불러와 화면에 표시합니다.
* **과거 내역 관리 기능**:
    * **재활용 (보류)**: "이 내역으로 새로 정산하기" 기능은 현재 우선순위에서 제외하고 추후 재검토합니다.
    * **삭제**: 읽기 전용 화면 또는 사이드바 목록에서 특정 내역을 삭제할 수 있는 버튼을 추가하고, 실수 방지를 위해 확인 절차를 포함합니다.

### **3. (신규) 정산 상태 관리 및 재활성화 기능 (완료)**

* **목표**: 버전 관리의 복잡도 증가 없이, 사용자가 실수로 '정산 완료'한 내역을 다시 수정할 수 있도록 하여 사용자 경험을 개선합니다.
* **구현 방안**:
    1.  **데이터베이스 설계**: `settlements` 테이블에 **`status` 컬럼을 추가**합니다. 이 컬럼은 `active`(활성/편집 중) 또는 `archived`(보관/완료) 두 가지 상태 값을 가집니다.
    2.  **'정산 완료' 시 로직**:
        * 사용자가 '정산 완료'를 최종 확인하면, 해당 정산 데이터의 `status`를 `archived`로 업데이트합니다.
        * 프론트엔드에서는 `status`가 `archived`인 데이터를 '과거 정산 내역' 목록에 표시하고, 읽기 전용으로 처리합니다.
    3.  **'정산 재활성화' 기능 추가 (관리자 또는 특정 권한)**:
        * 읽기 전용 화면에 **"수정하기 (재활성화)" 버튼을 추가**합니다.
        * 버튼 클릭 시, "보관된 정산을 다시 수정하시겠습니까?" 와 같은 확인 절차를 거칩니다.
        * 사용자가 확인하면, 해당 데이터의 `status`를 다시 `active`로 변경합니다.
        * `status`가 `active`로 변경된 데이터는 '과거 정산 내역' 목록에서 사라지고, 다시 메인 정산 편집 화면으로 불러와 수정을 이어갈 수 있게 합니다.

### **4. 정산표 UI/UX 개선**

* **제목 행 및 열 고정 기능 (Sticky Headers)**: 사용자가 상하좌우로 스크롤 하더라도 참석자 이름이 표시된 제목 행과 비용 항목이 표시된 제목 열은 항상 화면에 고정되어 보이도록 수정합니다. 이 기능은 모바일과 데스크톱 환경 모두에 동일하게 적용하여 가독성을 극대화합니다.

### **5. 참석자 조회 기능 추가**

* **참석자 필터 UI 추가**: 정산표 좌측 상단에 필터 버튼 및 참석자 선택 UI를 추가합니다.
* **필터 기능 강화**:
    * **드롭다운 선택**: 현재 등록된 참석자 목록을 드롭다운(Dropdown)으로 제공하여 오타 없이 쉽게 선택할 수 있도록 합니다.
    * **결과 하이라이트**: 참석자 선택 시, 해당 참석자와 관련된 정산표 항목만 표시하며, **시각적으로 눈에 띄게 강조(highlight)**하여 가독성을 높입니다.

### **6. 부가 기능 추가**

* **댓글 내 사진 첨부 기능**:
    * **기능 정의**: 사용자가 댓글을 작성할 때 영수증, 모임 사진 등 사진 파일을 첨부할 수 있도록 합니다.
    * **이미지 최적화 (필수)**: 업로드된 이미지는 스토리지 비용 절감 및 빠른 로딩 속도를 위해 웹 환경에 최적화된 크기(예: 최대 1920px)와 용량으로 자동 리사이즈 및 압축하여 저장합니다. 이는 안정성을 위해 클라이언트와 서버 양단에서 모두 처리하는 것을 원칙으로 합니다.
    * **구현 범위 (1단계 - MVP)**:
        * 댓글 하나당 하나의 이미지만 첨부하도록 제한.
        * 단순 파일 선택 버튼으로 업로드 기능 제공.
        * 첨부된 사진은 댓글 내용과 함께 표시.

### **7. 기술적 고려사항**

* **인프라**: 이미지 파일 저장을 위한 별도의 클라우드 스토리지(예: AWS S3, Google Cloud Storage) 도입이 필수적입니다.
* **데이터베이스**:
    * 정산 내역의 상태 관리를 위해 `settlements` 테이블에 **`status` 컬럼 (예: VARCHAR 또는 ENUM 타입) 추가**가 필요합니다.
    * 데이터 구조의 유연성을 위해 `settlement_data`, `comments_data` 등은 JSON 또는 JSONB 타입 사용을 권장합니다.
    * 댓글 내 이미지 주소를 저장하기 위해 `comments` 데이터 구조에 `image_url`과 같은 컬럼을 추가해야 합니다.
* **API**:
    * 정산 상태를 변경(예: `active` ↔ `archived`)하기 위한 **`PATCH /settlements/{id}/status`** 와 같은 API 엔드포인트 설계가 필요합니다.
    * 과거 기록 삭제(DELETE), 이미지 파일 업로드(POST) 등을 처리할 새로운 API 엔드포인트 설계가 필요합니다.
* **프론트엔드**:
    * 사이드바 추가에 따른 전체적인 레이아웃 재설계 및 반응형 디자인 적용이 필요합니다.
    * 정산표의 고정 행/열 기능은 CSS의 `position: sticky;` 속성을 활용하여 효율적으로 구현하는 것을 권장합니다.